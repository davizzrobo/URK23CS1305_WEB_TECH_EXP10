"use strict";(self.webpackChunkbudgetbuddy_client=self.webpackChunkbudgetbuddy_client||[]).push([[10],{8010:(e,s,a)=>{a.r(s),a.d(s,{default:()=>A});var r=a(5043),t=a(3519),c=a(4282),n=a(8258),i=a(4063),d=a(4196),o=a(6509),l=a(5016),m=a(3216),h=a(9722),u=a(2145),x=a(579);const A=()=>{const{user:e}=(0,l.A)(),s=(0,m.Zp)(),[a,A]=(0,r.useState)(!0),[f,j]=(0,r.useState)([]),[N,p]=(0,r.useState)(null);(0,r.useEffect)(()=>{e&&"admin"!==e.role&&(u.oR.error("Access denied. Admin only."),s("/dashboard"))},[e,s]),(0,r.useEffect)(()=>{b()},[]);const b=async()=>{try{A(!0);const e=localStorage.getItem("token"),s=await h.A.get("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"http://localhost:5000/api","/admin/requests"),{headers:{Authorization:"Bearer ".concat(e)}});j(s.data.data.requests)}catch(e){console.error("Error fetching requests:",e),u.oR.error("Failed to load admin requests")}finally{A(!1)}};return a?(0,x.jsx)(t.A,{className:"admin-requests mt-5",children:(0,x.jsxs)("div",{className:"text-center",children:[(0,x.jsx)("div",{className:"spinner-border text-purple",role:"status",children:(0,x.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,x.jsx)("p",{className:"mt-3",children:"Loading admin requests..."})]})}):(0,x.jsxs)(t.A,{className:"admin-requests",fluid:!0,children:[(0,x.jsxs)("div",{className:"requests-header",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h1",{children:"\ud83d\udc51 Admin Access Requests"}),(0,x.jsx)("p",{className:"text-muted",children:"Review and approve admin access requests"})]}),(0,x.jsx)(c.A,{variant:"outline-primary",onClick:()=>s("/admin"),children:"\u2190 Back to Dashboard"})]}),0===f.length?(0,x.jsx)(n.A,{className:"no-requests-card",children:(0,x.jsxs)(n.A.Body,{className:"text-center py-5",children:[(0,x.jsx)("div",{className:"empty-icon",children:"\u2713"}),(0,x.jsx)("h3",{children:"No Pending Requests"}),(0,x.jsx)("p",{className:"text-muted",children:"There are currently no pending admin access requests."})]})}):(0,x.jsxs)(n.A,{className:"requests-card",children:[(0,x.jsx)(n.A.Header,{children:(0,x.jsxs)("h5",{children:["\ud83d\udccb Pending Requests",(0,x.jsx)(i.A,{bg:"warning",className:"ms-2",children:f.length})]})}),(0,x.jsx)(n.A.Body,{children:(0,x.jsxs)(d.A,{responsive:!0,hover:!0,className:"requests-table",children:[(0,x.jsx)("thead",{children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"#"}),(0,x.jsx)("th",{children:"Name"}),(0,x.jsx)("th",{children:"Email"}),(0,x.jsx)("th",{children:"Requested On"}),(0,x.jsx)("th",{children:"Current Role"}),(0,x.jsx)("th",{children:"Actions"})]})}),(0,x.jsx)("tbody",{children:f.map((e,s)=>{return(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:s+1}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"user-info",children:[(0,x.jsx)("img",{src:e.profilePic,alt:e.name,className:"user-avatar"}),(0,x.jsx)("strong",{children:e.name})]})}),(0,x.jsx)("td",{children:e.email}),(0,x.jsx)("td",{children:(a=e.adminRequestedAt,new Date(a).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))}),(0,x.jsx)("td",{children:(0,x.jsx)(i.A,{bg:"secondary",children:"User"})}),(0,x.jsx)("td",{children:(0,x.jsxs)("div",{className:"action-buttons",children:[(0,x.jsx)(c.A,{size:"sm",variant:"success",onClick:()=>(async(e,s)=>{if(window.confirm("Are you sure you want to approve ".concat(s," as admin?")))try{p(e);const a=localStorage.getItem("token");await h.A.put("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"http://localhost:5000/api","/admin/requests/").concat(e,"/approve"),{},{headers:{Authorization:"Bearer ".concat(a)}}),u.oR.success("\u2705 ".concat(s," has been promoted to admin!")),b()}catch(a){console.error("Error approving request:",a),u.oR.error("Failed to approve request")}finally{p(null)}})(e._id,e.name),disabled:N===e._id,children:N===e._id?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("span",{className:"spinner-border spinner-border-sm me-1"}),"Processing..."]}):(0,x.jsx)(x.Fragment,{children:"\u2713 Approve"})}),(0,x.jsx)(c.A,{size:"sm",variant:"danger",onClick:()=>(async(e,s)=>{if(window.confirm("Are you sure you want to reject ".concat(s,"'s admin request?")))try{p(e);const a=localStorage.getItem("token");await h.A.put("".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"http://localhost:5000/api","/admin/requests/").concat(e,"/reject"),{},{headers:{Authorization:"Bearer ".concat(a)}}),u.oR.success("\u274c ".concat(s,"'s request has been rejected")),b()}catch(a){console.error("Error rejecting request:",a),u.oR.error("Failed to reject request")}finally{p(null)}})(e._id,e.name),disabled:N===e._id,className:"ms-2",children:"\u2717 Reject"})]})})]},e._id);var a})})]})})]}),(0,x.jsxs)(o.A,{variant:"info",className:"mt-4",children:[(0,x.jsx)(o.A.Heading,{children:"\u2139\ufe0f About Admin Requests"}),(0,x.jsx)("p",{className:"mb-0",children:'When users register and check "Request Admin Access", their request appears here. As an admin, you can approve or reject these requests. Approved users will be promoted to admin role and gain access to all admin features.'})]})]})}},8258:(e,s,a)=>{a.d(s,{A:()=>z});var r=a(9379),t=a(45),c=a(8139),n=a.n(c),i=a(5043),d=a(7852),o=a(579);const l=["className","bsPrefix","as"],m=i.forwardRef((e,s)=>{let{className:a,bsPrefix:c,as:i="div"}=e,m=(0,t.A)(e,l);return c=(0,d.oU)(c,"card-body"),(0,o.jsx)(i,(0,r.A)({ref:s,className:n()(a,c)},m))});m.displayName="CardBody";const h=m,u=["className","bsPrefix","as"],x=i.forwardRef((e,s)=>{let{className:a,bsPrefix:c,as:i="div"}=e,l=(0,t.A)(e,u);return c=(0,d.oU)(c,"card-footer"),(0,o.jsx)(i,(0,r.A)({ref:s,className:n()(a,c)},l))});x.displayName="CardFooter";const A=x,f=i.createContext(null);f.displayName="CardHeaderContext";const j=f,N=["bsPrefix","className","as"],p=i.forwardRef((e,s)=>{let{bsPrefix:a,className:c,as:l="div"}=e,m=(0,t.A)(e,N);const h=(0,d.oU)(a,"card-header"),u=(0,i.useMemo)(()=>({cardHeaderBsPrefix:h}),[h]);return(0,o.jsx)(j.Provider,{value:u,children:(0,o.jsx)(l,(0,r.A)((0,r.A)({ref:s},m),{},{className:n()(c,h)}))})});p.displayName="CardHeader";const b=p,v=["bsPrefix","className","variant","as"],y=i.forwardRef((e,s)=>{let{bsPrefix:a,className:c,variant:i,as:l="img"}=e,m=(0,t.A)(e,v);const h=(0,d.oU)(a,"card-img");return(0,o.jsx)(l,(0,r.A)({ref:s,className:n()(i?"".concat(h,"-").concat(i):h,c)},m))});y.displayName="CardImg";const g=y,P=["className","bsPrefix","as"],R=i.forwardRef((e,s)=>{let{className:a,bsPrefix:c,as:i="div"}=e,l=(0,t.A)(e,P);return c=(0,d.oU)(c,"card-img-overlay"),(0,o.jsx)(i,(0,r.A)({ref:s,className:n()(a,c)},l))});R.displayName="CardImgOverlay";const _=R,S=["className","bsPrefix","as"],C=i.forwardRef((e,s)=>{let{className:a,bsPrefix:c,as:i="a"}=e,l=(0,t.A)(e,S);return c=(0,d.oU)(c,"card-link"),(0,o.jsx)(i,(0,r.A)({ref:s,className:n()(a,c)},l))});C.displayName="CardLink";const q=C;var E=a(4488);const T=["className","bsPrefix","as"],w=(0,E.A)("h6"),O=i.forwardRef((e,s)=>{let{className:a,bsPrefix:c,as:i=w}=e,l=(0,t.A)(e,T);return c=(0,d.oU)(c,"card-subtitle"),(0,o.jsx)(i,(0,r.A)({ref:s,className:n()(a,c)},l))});O.displayName="CardSubtitle";const U=O,k=["className","bsPrefix","as"],H=i.forwardRef((e,s)=>{let{className:a,bsPrefix:c,as:i="p"}=e,l=(0,t.A)(e,k);return c=(0,d.oU)(c,"card-text"),(0,o.jsx)(i,(0,r.A)({ref:s,className:n()(a,c)},l))});H.displayName="CardText";const D=H,L=["className","bsPrefix","as"],F=(0,E.A)("h5"),I=i.forwardRef((e,s)=>{let{className:a,bsPrefix:c,as:i=F}=e,l=(0,t.A)(e,L);return c=(0,d.oU)(c,"card-title"),(0,o.jsx)(i,(0,r.A)({ref:s,className:n()(a,c)},l))});I.displayName="CardTitle";const B=I,W=["bsPrefix","className","bg","text","border","body","children","as"],K=i.forwardRef((e,s)=>{let{bsPrefix:a,className:c,bg:i,text:l,border:m,body:u=!1,children:x,as:A="div"}=e,f=(0,t.A)(e,W);const j=(0,d.oU)(a,"card");return(0,o.jsx)(A,(0,r.A)((0,r.A)({ref:s},f),{},{className:n()(c,j,i&&"bg-".concat(i),l&&"text-".concat(l),m&&"border-".concat(m)),children:u?(0,o.jsx)(h,{children:x}):x}))});K.displayName="Card";const z=Object.assign(K,{Img:g,Title:B,Subtitle:U,Body:h,Link:q,Text:D,Header:b,Footer:A,ImgOverlay:_})}}]);
//# sourceMappingURL=10.c2df2ea1.chunk.js.map